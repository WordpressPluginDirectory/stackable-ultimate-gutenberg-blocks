"use strict";(globalThis.webpackChunkstackable=globalThis.webpackChunkstackable||[]).push([[35],{8324:(e,t,n)=>{n.r(t),n.d(t,{getBlockName:()=>u,fetchDesignLibrary:()=>d,fetchDesign:()=>m,setDevModeDesignLibrary:()=>g,getDesigns:()=>b,filterDesigns:()=>_,getDesign:()=>p});var l=n(6179),r=n.n(l),s=n(3882);const a="v4";let o={},c={},i={};const u=e=>e.replace(/^[\w-]+\//,""),d=async function(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"patterns";if(n&&((0,s.doAction)("stackable.design-library.reset-cache"),o={},c={},i={}),"patterns"===u&&!Object.keys(c).length||"pages"===u&&!Object.keys(i).length){const e=await r()({path:`/stackable/v2/design_library/${u}${n?"/reset":""}`,method:"GET"});var d,m;o[u]=e,"patterns"===u?c=null!==(d=e.v4)&&void 0!==d?d:{}:i=null!==(m=e.v4)&&void 0!==m?m:{}}return null!==(e=null===(t=o[u])||void 0===t?void 0:t[l||a])&&void 0!==e?e:o[u]},m=async e=>(c[e]||await d(),c[e]||{}),g=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=await r()({path:"/stackable/v2/design_library_dev_mode/",method:"POST",data:{devmode:e}});return await t},b=async e=>{let{reset:t=!1,type:n="patterns"}=e;const l=await d(t,a,n);if(l.wp_remote_get_error||l.content_error){var r;const e=null!==(r=l.wp_remote_get_error)&&void 0!==r?r:l.content_error;return console.error("Stackable: ",e),{error:e}}return"pages"===n&&await d(),Object.values(l)},_=async e=>{let{library:t=[],plan:n="",category:l=""}=e;return n&&(t=t.filter((e=>{let{plan:t}=e;return t===n}))),l&&(t=t.filter((e=>{let{category:t}=e;return t===l}))),t},p=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=await d(!1,t),l=n[e];let r=await(0,s.applyFilters)("stackable.design-library.get-design",null,e,l,t);return!r&&l.template&&(r=await m(e,t)),r}},3324:(e,t,n)=>{n.r(t),n.d(t,{default:()=>q});var l=n(2610),r=n(7462);n(7294);const s=function(e){return(0,l.createElement)("svg",(0,r.Z)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e),(0,l.createElement)("path",{d:"M504 256c0 137-111 248-248 248S8 393 8 256C8 119.1 119 8 256 8s248 111.1 248 248zM262.7 90c-54.5 0-89.3 23-116.5 63.8-3.5 5.3-2.4 12.4 2.7 16.3l34.7 26.3c5.2 3.9 12.6 3 16.7-2.1 17.9-22.7 30.1-35.8 57.3-35.8 20.4 0 45.7 13.1 45.7 33 0 15-12.4 22.7-32.5 34-23.7 13-54.8 29.4-54.8 70.5v4c0 6.6 5.4 12 12 12h56c6.6 0 12-5.4 12-12v-1.3c0-28.5 83.2-29.6 83.2-106.7 0-58-60.2-102-116.5-102zM256 338c-25.4 0-46 20.6-46 46s20.6 46 46 46 46-20.6 46-46-20.6-46-46-46z"}))};var a=n(8085),o=n(910),c=n(4184),i=n.n(c),u=n(8003),d=n(7537);const m=e=>{const[t,n]=(0,l.useState)([]),{viewBy:r,designs:s,plan:c,selected:m,onSelect:g}=e;return(0,l.useEffect)((()=>{let e=0;const t=s.reduce(((t,n)=>{const l=n.category;return c&&c!==n.plan||(l in t?t[l].count++:t[l]={id:l,label:l,count:1},e++),t}),{});t.all={id:"",label:"    ",count:e};const l=(0,a.sortBy)(Object.values(t),"label");l[0].label=(0,u.__)("All",o.i18n),n(l)}),[s,r,c]),e.isBusy?(0,l.createElement)(d.Spinner,{style:{display:"block",margin:"0 auto"}}):(0,l.createElement)("ul",{className:"ugb-block-list"},t.reduce(((e,t)=>{const{id:n,label:r,count:s}=t,a=i()(["stk-design-library__sidebar-item"],{"is-active":m===n});return e.push((0,l.createElement)("li",{key:n},(0,l.createElement)("div",{className:a,"data-count":s,onClick:()=>g(n),onKeyPress:e=>{13===e.keyCode&&(void 0).click()},role:"button",tabIndex:0,"aria-pressed":m===n?"true":"false"},r,(0,l.createElement)("span",{className:"ugb-block-list__count","data-testid":`${n}-count`},s)))),e}),[]))};m.defaultProps={select:"",onSelect:()=>{},apiVersion:"",designs:[]};const g=m;var b=n(4774);const _=[{key:"",label:(0,u.__)("All",o.i18n)},{key:"free",label:(0,u.__)("Free",o.i18n)},{key:"premium",label:(0,u.__)("Premium",o.i18n)}],p=e=>{const{selectedTab:t,setSelectedTab:n,selectedPlan:r,setSelectedPlan:s,setDoReset:a,onClose:c}=e;return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(b.AdvancedToolbarControl,{className:"stk-design-library-tabs",fullwidth:!1,controls:[{value:"patterns",title:(0,u.__)("Patterns",o.i18n)},{value:"pages",title:(0,u.__)("Pages",o.i18n)}],value:t,onChange:n,isToggleOnly:!0,allowReset:!1}),(0,l.createElement)("div",{className:"stk-design-library__header-settings"},o.devMode&&(0,l.createElement)(d.ToggleControl,{label:"Dev Mode",checked:!!localStorage.getItem("stk__design_library__dev_mode")||!1,onChange:e=>{localStorage.setItem("stk__design_library__dev_mode",e?"1":""),setTimeout((()=>{var e,t;null===(e=document)||void 0===e||null===(t=e.querySelector(".ugb-insert-library-button__wrapper .ugb-insert-library-button"))||void 0===t||t.click()}),100),c()},__nextHasNoMarginBottom:!0}),(0,l.createElement)(b.Button,{icon:"image-rotate",iconSize:14,label:(0,u.__)("Refresh Library",o.i18n),className:"ugb-modal-design-library__refresh",onClick:()=>a(!0)}),!o.isPro&&(0,l.createElement)(d.Dropdown,{focusOnMount:"container",renderToggle:e=>{let{onToggle:t}=e;return(0,l.createElement)(b.Button,{onClick:t,style:{height:"auto"},icon:"arrow-down-alt2",iconSize:12,iconPosition:"right",variant:"secondary"},(0,l.createElement)(d.Dashicon,{icon:"lock",size:12}),(0,l.createElement)("span",null,r.label))},renderContent:e=>{let{onClose:t}=e;return(0,l.createElement)("div",{className:"stk-design-library__plan-dropdown"},_.map(((e,n)=>(0,l.createElement)(b.Button,{key:n,onClick:()=>{s(e),t()}},e.label))))}})))};var h=n(3882),y=n(8573);const k=()=>{},v=e=>{let{blocks:t="",shadowRoot:n,selectedTab:r,designIndex:s,onMouseDown:a=k,updateShadowBodySize:o=k,setIsLoading:c}=e;const u=(0,l.useRef)(null),d=(0,l.useRef)(null),m=(0,l.useRef)(!1),g=(0,l.useRef)(0),b=(0,l.useRef)(0),_=e=>{a(),m.current=!0,g.current=e.clientY;const t=u.current;t&&(b.current=t.scrollTop)},p=e=>{if(!m.current)return;const t=u.current;if(t){const n=e.clientY-g.current;t.scrollTop=b.current-4*n}},v=()=>{m.current=!1};(0,l.useEffect)((()=>{const e=u.current;if(e&&"patterns"!==r)return e.addEventListener("mousedown",_),window.addEventListener("mousemove",p),window.addEventListener("mouseup",v),()=>{e.removeEventListener("mousedown",_),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",v)}}),[r]);const f=i()((0,h.applyFilters)("stackable.global-styles.classnames",["entry-content"]),{"preview-pages":"pages"===r});return(0,l.useEffect)((()=>{const e=d.current;if(!e||!t)return;c(!0);const n=window.requestIdleCallback?e=>window.requestIdleCallback(e,{timeout:5e3}):e=>setTimeout(e,20*s),l=(0,y.safeHTML)(t);if("pages"!==r||s<9)return e.innerHTML=l,void requestAnimationFrame((()=>{n((()=>c(!1)))}));requestAnimationFrame((()=>{n((()=>{e.innerHTML=l,o(),requestAnimationFrame((()=>{n((()=>c(!1)))}))}))}))}),[t,n]),(0,l.createPortal)((0,l.createElement)(l.Fragment,null,(0,l.createElement)("body",{ref:u,className:f},(0,l.createElement)("div",{ref:d,style:{pointerEvents:"none"}}))),n)};var f=n(470),E=n(3284),S=n(5019);const w="dist/images/lazy-components-design-library-maps.0f15487.webp";var C=n(8324),N=n(378),T=n(1205);const B={...S},M=()=>{},R=(0,l.memo)((e=>{const{shouldRender:t,presetMarks:n,previewProps:r,isMultiSelectBusy:s}=e,{selectedTab:c,selectedNum:m,selectedData:g,plan:_,label:p}=r,y=Array.isArray(n)&&n.length>=2?n[n.length-2].value:120,[k,S]=(0,l.useState)(!0),[R,D]=(0,l.useState)(!1),{hostRef:I,shadowRoot:P,stylesLoaded:x}=(e=>{const t=(0,l.useRef)(null),[n,r]=(0,l.useState)(null),[s,a]=(0,l.useState)(0),{getEditorDom:c}=(0,E.useSelect)("stackable/editor-dom"),i=c(),u=(0,h.applyFilters)("stackable.global-styles.ids",["ugb-dep-native-global-style-css-nodep-inline-css","ugb-style-css-css","ugb-style-css-responsive-css","ugb-block-style-inheritance-nodep-inline-css","ugb-style-css-premium-css"]);return(0,l.useEffect)((()=>{if(e&&t.current){const e=t.current.shadowRoot||t.current.attachShadow({mode:"open"});a(0);const n=new Set(Array.from(e.querySelectorAll("style[id],link[id]")).map((e=>e.id))),l=u.map((e=>{let t=null,n=null;if(document&&document.head&&(n=document.head.querySelector(`#${e}`)),!n&&i){var l;const t=null==i?void 0:i.closest("body");n=(null==t||null===(l=t.ownerDocument)||void 0===l?void 0:l.head).querySelector(`#${e}`)}return n&&(t=n.cloneNode(!0)),t})).filter((e=>null!==e));if(!n.has("global-styles-inline-css")){const e=document.createElement("style");e.setAttribute("id","global-styles-inline-css"),e.innerHTML=o.wpGlobalStylesInlineCss,l.push(e)}if(!n.has("stk-design-library-styles")){const e=document.createElement("style");e.setAttribute("id","stk-design-library-styles"),e.innerHTML+=(0,f.yU)(),l.push(e)}l.forEach((t=>{t.id&&n.has(t.id)||(t.href&&(t.onload=()=>{a((e=>e+1))},t.onerror=()=>{a((e=>e+1))}),t.textContent&&(t.textContent=t.textContent.replace(/:root/g,":host")),e.appendChild(t),t.id&&n.add(t.id))})),r(e)}}),[e]),{hostRef:t,shadowRoot:n,stylesLoaded:s}})(t),A=(0,l.useRef)(null),{blocks:F,enableBackground:z,shadowBodySizeRef:O,blocksForSubstitutionRef:L,previewSize:q,onClickDesign:H,updateShadowBodySize:j}=((e,t,n,r,s,c,i,u)=>{const{designId:d,template:m,category:g,plan:b,containerScheme:_,backgroundScheme:p,enableBackground:h,selectedTab:y,selectedNum:k,selectedData:v,onClick:S}=e,[M,R]=(0,l.useState)({parsed:null,serialized:""}),[D,I]=(0,l.useState)(""),[P,x]=(0,l.useState)(null),[A,F]=(0,l.useState)({}),z=(0,l.useRef)([]),O=(0,l.useRef)(!1),L=(0,l.useRef)(!1),q=(0,l.useRef)(null),H=(0,l.useRef)(null),j=(0,l.useRef)(y),$=(0,l.useRef)(k),Y=(0,l.useRef)(null),G=(0,l.useRef)(!1),V=(0,E.useSelect)((e=>{var t;return(null===(t=e("core").getEntityRecord("root","site"))||void 0===t?void 0:t.title)||"InnovateCo"}),[]),W=o.devMode&&"1"===localStorage.getItem("stk__design_library__dev_mode"),U="patterns"===y,K=e=>{const t=e||(null==c?void 0:c.querySelector("body"));t&&(q.current={clientHeight:t.clientHeight,scrollHeight:t.scrollHeight,maxScrollTop:t.scrollHeight-t.clientHeight})},Z=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const l=null==r||null===(e=r.current)||void 0===e?void 0:e.querySelector(".stk-block-design__design-container");if(!(r.current&&s.current&&c&&l)||k&&j.current===y||!t||n>3)return;const a=r.current.getBoundingClientRect(),o=s.current.getBoundingClientRect(),i=l.getBoundingClientRect(),u=a.width,d=o.width,m=Math.abs(i.height-o.height)<1;let g=!0;Math.abs(u-d)<1&&m&&(t-=1,g=!1);const b=c.querySelector("body");if(b&&g){const e=u>0?u/1300:1;let t=1200;"patterns"===y&&(t=b.offsetHeight);const n=parseFloat(t)*e;F((t=>{const l={...t,scale:e};return 0===Object.keys(t).length?(l.heightBackground=n,l.heightNoBackground=n):l[h?"heightBackground":"heightNoBackground"]=n,l})),K(b)}null!==Y.current&&cancelAnimationFrame(Y.current),Y.current=requestAnimationFrame((()=>Z(t,++n)))},J=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=(0,a.cloneDeep)((null==v?void 0:v.designData)||e);if(!t)return;""===_||k||(t=(0,f.R6)(t,_)),h&&!k&&(t=(0,f.Nl)(t,h,p,U)),"patterns"===y&&(0,f.W$)(t[0].attributes,z.current[0],n,!1);let l=(0,N.serialize)(t);if(z.current.includes("header")&&(l=l.replace(/<!--\s*wp:site-title(?:\s+[^\/]*?)?\/-->/g,(0,a.escape)(V))),z.current.includes("tabs")&&(l=l.replace('"stk-block-tabs__tab"','"stk-block-tabs__tab stk-block-tabs__tab--active"')),z.current.includes("post-loop")){const e=B["post-loop"];l=(0,f.i5)(l,e.posts_placeholder,e)}l.includes("stk-block-map")&&(l=l.replace(/(<div[^>]*class="[^"]*stk-block-map[^"]*"[^>]*>)([\s\S]*?)(<\/div>)/g,((e,t,n,l)=>t+n.replace(/<iframe[\s\S]*?<\/iframe>|<iframe[\s\S]*?\/>/g,'<img src="'+o.srcUrl+"/"+w+'" />')+l))),l=(0,f.wr)(l);const r=(0,T.cleanSerializedBlock)(l);R({parsed:t,serialized:r})};return(0,l.useEffect)((()=>{if(!t||G.current===m)return;i(!0),z.current=[],L.current=!1;let e=[],l=null;(async()=>{const t=m;if("patterns"===y){const n=(0,f.un)(d),r=(0,f.wT)(t,n,!1),s=W?(0,f.wT)(t,n,!0):r;z.current.push(n),r.includes('stk-design-library__bg-target="true"')&&(L.current=!0),e=(0,f.aj)(r),l=W?(0,f.aj)(s):null}else{const r=t.map((e=>e.designId||e.id)),s=await Promise.all(r.map((e=>(0,C.fetchDesign)(e)))),a=r.map((e=>(0,f.un)(e))),o=s.map(((e,t)=>(0,f.wT)(e.template||e.content,a[t],!1))).join("\n"),c=W?s.map(((e,t)=>(0,f.wT)(e.template||e.content,a[t],!0))).join("\n"):o;z.current.push(...a);const i=(0,f.aj)(o),u=W?(0,f.aj)(c):null;for(let r=0;r<t.length;r++){let s=i[r],o=W&&u?u[r]:null;t[r].bg&&(s=(0,f.Nl)([s],!0,"")[0],o&&(o=(0,f.Nl)([o],!0,"")[0])),(0,f.W$)(s.attributes,a[r],n,!1),o&&(0,f.W$)(o.attributes,a[r],n,!0),e.push(s),o&&(l=l||[],l.push(o))}}})().then((()=>{const[t,n]=(0,f._w)(e),r=l?(0,f._w)(l)[0]:null;O.current=n,I(t),x(r),i(!1),G.current=m}))}),[m,t]),(0,l.useEffect)((()=>{j.current=y}),[y]),(0,l.useEffect)((()=>{t&&D&&c&&(($.current||$.current===k)&&k?($.current=k,D&&J()):$.current=k)}),[k,c]),(0,l.useEffect)((()=>{t&&D&&c&&(k&&j.current===y||(D&&J(),null!==Y.current&&cancelAnimationFrame(Y.current),Y.current=requestAnimationFrame((()=>Z()))))}),[D,_,p,h,k,t,c]),(0,l.useEffect)((()=>{M.parsed&&M.serialized&&t&&H.current!==h&&(H.current=h,null!==Y.current&&cancelAnimationFrame(Y.current),Y.current=requestAnimationFrame((()=>Z())))}),[M,h]),(0,l.useEffect)((()=>{M.parsed&&M.serialized&&t&&(null!==Y.current&&cancelAnimationFrame(Y.current),Y.current=requestAnimationFrame((()=>Z())))}),[u]),(0,l.useEffect)((()=>()=>{cancelAnimationFrame(Y.current),Y.current=null}),[]),{blocks:M.serialized,enableBackground:h,shadowBodySizeRef:q,blocksForSubstitutionRef:O,previewSize:A,onClickDesign:()=>{if(!o.isPro&&"free"!==b)return;const e=r.current.getBoundingClientRect(),t={preview:h?A.heightBackground:A.heightNoBackground,card:e.height,scale:A.scale};S(d,g,P||M.parsed,O.current,t)},updateShadowBodySize:K}})(r,t,y,A,I,P,S,x),{onMouseOut:$,onMouseOver:Y,onMouseDown:G}=((e,t,n)=>{const r=(0,l.useRef)(0),s=(0,l.useRef)(null),a=(0,l.useRef)(!1),o=(0,l.useRef)(null),c=(e,n)=>{if(!e||!a.current)return;const l=e.scrollTop,o=n-l,i=1-o/t.current.maxScrollTop;if(Math.abs(o)<1)return void(a.current=!1);const u=8*i*(1-i),d=Math.max(20*u,5);e.scrollTop=l+d,r.current=e.scrollTop,s.current=requestAnimationFrame((()=>c(e,n)))},i=(0,l.useCallback)((()=>{a.current=!1,s.current&&(cancelAnimationFrame(s.current),s.current=null),o.current&&(clearTimeout(o.current),o.current=null),r.current=-1}),[]);return(0,l.useEffect)((()=>()=>{a.current=!1,s.current&&(cancelAnimationFrame(s.current),s.current=null),o.current&&(clearTimeout(o.current),o.current=null),r.current=-1}),[]),{onMouseOver:"patterns"===n?M:()=>{var n,l,i;const u=null==e||null===(n=e.current)||void 0===n||null===(l=n.shadowRoot)||void 0===l||null===(i=l.querySelector)||void 0===i?void 0:i.call(l,"body");u&&t.current&&(r.current=0,a.current=!0,o.current&&(clearTimeout(o.current),o.current=null),o.current=setTimeout((()=>{if(-1===r.current||!a.current)return;s.current&&cancelAnimationFrame(s.current);const e=t.current.maxScrollTop;e>0&&c(u,e),o.current=null}),1e3))},onMouseOut:"patterns"===n?M:()=>{var t,n,l;const c=null==e||null===(t=e.current)||void 0===t||null===(n=t.shadowRoot)||void 0===n||null===(l=n.querySelector)||void 0===l?void 0:l.call(n,"body");c&&(a.current=!1,s.current&&(cancelAnimationFrame(s.current),s.current=null),o.current&&(clearTimeout(o.current),o.current=null),c.scrollTo({top:0,behavior:"smooth"}),r.current=-1)},onMouseDown:"patterns"===n?M:i}})(I,O,c),V=(0,l.useMemo)((()=>{const e="pages"===c?345:100,t=m&&g?g.selectedPreviewSize.preview:z?q.heightBackground:q.heightNoBackground;return F&&t?t:e}),[c,m,g,q,F,z]),W=i()(["ugb-design-library-item","ugb-design-library-item--toggle"],{[`ugb--is-${_}`]:!o.isPro&&"free"!==_,"ugb--is-toggled":m,"ugb--is-hidden":!t});return(0,l.createElement)("button",{className:W,ref:A,onClick:e=>{e.stopPropagation(),"pages"!==c&&H()},onMouseOut:$,onMouseOver:Y},!o.isPro&&"free"!==_&&(0,l.createElement)("span",{className:"stk-pulsating-circle",role:"presentation"}),(0,l.createElement)("div",{style:{position:"relative"},className:"stk-block-design__design-container "+(V>100?"stk--design-preview-large":"stk--design-preview-small")},!o.isPro&&"free"!==_&&(0,l.createElement)(b.ProControl,{type:"design-library",showImage:!1,showHideNote:!1}),(0,l.createElement)("div",{className:"stk-spinner-container "+(k||!t?"":"stk-hide-spinner")},(0,l.createElement)(d.Spinner,null)),(0,l.createElement)("div",{className:"stk-block-design__host-container",style:{transform:`scale(${m&&g?g.selectedPreviewSize.scale:null==q?void 0:q.scale})`,transformOrigin:"top left",height:V}},(0,l.createElement)("div",{className:"stk-block-design__host",ref:I},t&&P&&(0,l.createElement)(v,{blocks:F,shadowRoot:P,selectedTab:c,designIndex:e.designIndex,onMouseDown:G,updateShadowBodySize:j,setIsLoading:S})))),(0,l.createElement)("footer",{"data-selected-num":m},(0,l.createElement)("div",null,(0,l.createElement)("h4",null," ",p," "),!1!==L.current&&0!==L.current.size&&(0,l.createElement)(b.Tooltip,{text:(0,u.__)("This design contains disabled blocks. You can still insert this design with blocks substituted with other enabled blocks.",o.i18n)},(0,l.createElement)(d.Dashicon,{icon:"warning",size:16}))),(0,l.createElement)("div",null,0!==m&&(0,l.createElement)(b.Tooltip,{text:(0,u.__)("Style options are locked for this design because it is selected.",o.i18n)},(0,l.createElement)(d.Dashicon,{icon:"editor-help",size:16})),"patterns"===c?(0,l.createElement)("span",{className:"stk-block-design__selected-num"},0===m?"":m):(0,l.createElement)("div",null,(0,l.createElement)(b.Button,{label:(0,u.__)("Insert",o.i18n),className:"ugb-modal-design-library__add-multi "+(R?"stk--is-selected":""),disabled:s,onClick:()=>{D(!0),H()}},(0,u.__)("Insert",o.i18n),s&&(0,l.createElement)(d.Spinner,null))))))}));R.defaultProps={designId:"",image:"",label:"",onClick:()=>{},plan:"free",premiumLabel:(0,u.__)("Go Premium",o.i18n)};const D=R,I=(0,l.createContext)(null);var P=n(3796);const x=(0,l.memo)((e=>{const{className:t="",designs:n,isBusy:r,errors:s}=e,a=(0,l.useRef)(null),c=i()(["ugb-design-library-items",t]);return(0,l.useEffect)((()=>{a.current.scrollTop=0}),[n]),(0,l.createElement)("div",{className:"ugb-modal-design-library__designs",ref:a},r&&(0,l.createElement)(d.Spinner,{style:{display:"block",margin:"0 auto"}}),!r&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:c},(n||[]).map(((e,t)=>(0,l.createElement)(F,{design:e,key:e.id||e.designId,designIndex:t}))),!(n||[]).length&&(0,l.createElement)("p",{className:"components-base-control__help","data-testid":"nothing-found-note"},(0,u.__)("No designs found",o.i18n)),"object"==typeof s&&s&&Object.keys(s).length&&(0,l.createElement)("p",{className:"components-base-control__help"},(0,l.createElement)("strong",null,(0,u.__)("An error has occurred:",o.i18n)),(0,l.createElement)("br",null),Object.values(s).join("; ")))))}));x.defaultProps={designs:[],columns:3,onSelect:()=>{},isBusy:!1};const A=x,F=(0,l.memo)((e=>{const{design:t,designIndex:n}=e,r=(0,l.useRef)(null),[s,a]=(0,l.useState)(n<9),[o,c,i,u,d,m,g,b]=(0,l.useContext)(I),{selectedNum:_,selectedData:p}=(0,l.useMemo)((()=>{const e=c.indexOf(t.id||t.designId)+1;return{selectedNum:e,selectedData:e?i[e-1]:null}}),[c,i]),h=(0,l.useMemo)((()=>({designId:t.id||t.designId,template:t.template||t.content,category:t.category,plan:t.plan,label:t.label,containerScheme:m,backgroundScheme:g,enableBackground:"pages"===o||b,selectedTab:o,selectedNum:_,selectedData:p,onClick:u})),[t.id||t.designId,m,g,b,o,_,u]),{getPresetMarks:y}=(0,P.usePresetControls)("spacingSizes"),k=(0,l.useMemo)((()=>y()||null),[]);return(0,l.useEffect)((()=>{if("pages"!==o)return;let e;return e="undefined"!=typeof requestIdleCallback?requestIdleCallback((()=>s?{}:a(!0)),{timeout:500*(n+1)}):setTimeout((()=>a(!0)),500*n),()=>{"undefined"!=typeof cancelIdleCallback?cancelIdleCallback(e):clearTimeout(e)}}),[o]),(0,l.useEffect)((()=>{if("pages"===o)return;const e=document.querySelector(".ugb-modal-design-library__designs");if(!r.current||!e)return;const t=new IntersectionObserver((e=>{let[t]=e;requestAnimationFrame((()=>{requestAnimationFrame((()=>a(t.isIntersecting||t.intersectionRatio>0)))}))}),{root:e,rootMargin:"500px",scrollMargin:"500px",threshold:0});return t.observe(r.current),()=>t.disconnect()}),[o]),(0,l.createElement)("div",{ref:r},(0,l.createElement)(D,{previewProps:h,isMultiSelectBusy:d,shouldRender:s,presetMarks:k}))}));var z;const O={className:"ugb-design-library__color-scheme-popover",placement:"right-start",shift:!0};null===(z=localStorage)||void 0===z||z.setItem("stk__design_library__block-list__selected","");const L=e=>{const{backgroundModeColorScheme:t,containerModeColorScheme:n,colorSchemesCollection:r}=(0,P.useBlockColorSchemes)(),[a,c]=(0,l.useState)(!0),[m,h]=(0,l.useState)(!1),[y,k]=(0,l.useState)([]),[v,f]=(0,l.useState)([]),[E,S]=(0,l.useState)(!1),[w,N]=(0,T.useLocalStorage)("stk__design_library__block-list__view_by","patterns"),[B,M]=(0,T.useLocalStorage)("stk__design_library__block-list__selected",""),[R,D]=(0,T.useLocalStorage)("stk__design_library__view-plan",_[0]),[x,F]=(0,l.useState)([]),[z,L]=(0,l.useState)([]),[q,j]=(0,l.useState)(null),[$,Y]=(0,l.useState)(!1),[G,V]=(0,l.useState)(""),[W,U]=(0,l.useState)("");(0,l.useEffect)((()=>{window.localStorage.getItem("stk__design_library__version")||(window.localStorage.setItem("stk__design_library__version","v4"),N("patterns"),M(""))}),[]),(0,l.useEffect)((()=>{c(!0),F([]),j(null),(0,C.getDesigns)({reset:m,type:w}).then((e=>{let t=e;"object"==typeof e&&e.error&&(t=[],j(e.error)),F(t),M("")})).finally((()=>{h(!1),c(!1)}))}),[m,w]),(0,l.useEffect)((()=>{(0,C.filterDesigns)({library:x,category:B,plan:R.key}).then((e=>{L(e)}))}),[x,R,B]);const K=()=>!(!y.length||window.confirm((0,u.sprintf)((0,u.__)("You have one or more designs selected. Navigating to %s will close the Design Library and your current selection will be lost. Do you want to continue?",o.i18n),(0,u.__)("Color Schemes",o.i18n))))||(e.onClose(),!1),Z=t=>{S(!0),e.onSelect(t,(()=>S(!1)),w)},J=(0,l.useCallback)(((e,t,n,l,r)=>{"pages"!==w?(k((t=>{const n=[...t];if(n.includes(e)){const t=n.indexOf(e);n.splice(t,1)}else n.push(e);return n})),f((s=>{const a=[...s];if(s.some((t=>t.designId===e))){const t=a.findIndex((t=>t.designId===e));a.splice(t,1)}else a.push({designId:e,category:t,designData:n,blocksForSubstitution:l,selectedPreviewSize:r});return a}))):Z([{designId:e,category:t,designData:n,blocksForSubstitution:l,selectedPreviewSize:r}])}),[w]),Q=(0,l.useMemo)((()=>(0,l.createElement)(p,{selectedTab:w,setSelectedTab:N,selectedPlan:R,setSelectedPlan:D,setDoReset:h,onClose:e.onClose})),[w,R,N,D,h,e.onClose]),X=(0,l.useMemo)((()=>[w,y,v,J,E,G,W,$]),[w,y,v,J,E,G,W,$]);return(0,l.createElement)(d.Modal,{title:(0,u.__)("Stackable Design Library",o.i18n),headerActions:Q,className:i()("ugb-modal-design-library","ugb-modal-design-library--is-multiselect"),onRequestClose:e.onClose},(0,l.createElement)(I.Provider,{value:X},(0,l.createElement)("div",{className:i()("ugb-modal-design-library__wrapper",{"ugb-modal-design-library__full-pages":"pages"===w})},(0,l.createElement)(b.GuidedModalTour,{tourId:"design-library"}),(0,l.createElement)("aside",{className:"ugb-modal-design-library__sidebar"},(0,l.createElement)("div",{className:"ugb-modal-design-library__filters"},(0,l.createElement)(g,{designs:x,viewBy:w,plan:R.key,selected:B,onSelect:e=>M(e),isBusy:a})),(0,l.createElement)("div",{className:"ugb-modal-design-library__style-options"},(0,l.createElement)("div",null,(0,l.createElement)("h4",null,(0,u.__)("Style Options",o.i18n)),(0,l.createElement)(b.Tooltip,{className:"ugb-modal-design-library__style-options-tooltip",placement:"top",text:(0,l.createElement)(l.Fragment,null,(0,u.__)("Customize patterns using the options below.",o.i18n),"Â ",(0,l.createElement)("a",{href:"https://docs.wpstackable.com/article/343-using-the-design-library#Design-Library-Style-Options-Pswi5",target:"_docs"},(0,u.__)("Learn how to use style options.",o.i18n)))},(0,l.createElement)(s,{height:"14px",width:"14px"}))),"patterns"===w&&(0,l.createElement)(d.ToggleControl,{className:"ugb-modal-design-library__enable-background",label:(0,u.__)("Section Background",o.i18n),checked:$,onChange:e=>{Y(e)},__nextHasNoMarginBottom:!0}),(0,l.createElement)(d.BaseControl,{label:(0,u.__)("Background Scheme",o.i18n),className:"ugb-modal-design-library__color-scheme-label ugb-modal-design-library__background-scheme",__nextHasNoMarginBottom:!0},(0,l.createElement)(d.Dropdown,{className:"ugb-modal-design-library__color-scheme-dropdown",popoverProps:O,focusOnMount:"container",renderToggle:e=>{let{onToggle:n}=e;return(0,l.createElement)(b.Button,{onClick:n,className:"ugb-modal-design-library__stk-color-scheme stk-color-scheme__toggle"},""!==W?(0,l.createElement)(b.ColorSchemePreview,{isCollapsed:!0,colors:r[W||t].normal}):(0,l.createElement)(H,{label:(0,u.__)("Default",o.i18n)}))},renderContent:e=>{let{onClose:t}=e;return(0,l.createElement)("div",null,(0,l.createElement)("div",{className:"ugb-modal-design-library__stk-color-scheme-list-header"},(0,l.createElement)("p",null," ",(0,u.__)("Background Scheme",o.i18n)),(0,l.createElement)(b.Button,{icon:"no",className:"ugb-modal-design-library__color-scheme-close-button",onClick:()=>{t()}})),(0,l.createElement)("div",{className:"ugb-modal-design-library__stk-color-scheme-list"},(0,l.createElement)(b.Button,{className:"ugb-modal-design-library__stk-color-scheme"+(""===W?" stk-color-scheme__selected":""),onClick:()=>{$||Y(!0),U("")}},(0,l.createElement)("span",{className:"stk-color-scheme-name stk-color-scheme__none"}," ",(0,u.__)("Default",o.i18n)," ")),Object.entries(r).map(((e,t)=>{let[n,r]=e;return(0,l.createElement)(b.Button,{key:t,className:"ugb-modal-design-library__stk-color-scheme"+(W===n?" stk-color-scheme__selected":""),onClick:()=>{$||Y(!0),U(n)}},(0,l.createElement)(b.ColorSchemePreview,{colors:r.normal,isCollapsed:!0}),(0,l.createElement)("span",{className:"stk-color-scheme-name"}," ",r.name))})),Object.keys(r).length?(0,l.createElement)(b.ColorSchemesHelp,{customText:"",callback:K,className:"ugb-design-library__manage-scheme"}):(0,l.createElement)(b.ColorSchemesHelp,{customText:(0,u.__)("You do not have any color schemes.",o.i18n),callback:K})))}})),(0,l.createElement)(d.BaseControl,{label:(0,u.__)("Container Scheme",o.i18n),className:"ugb-modal-design-library__color-scheme-label",__nextHasNoMarginBottom:!0},(0,l.createElement)(d.Dropdown,{popoverProps:O,focusOnMount:"container",renderToggle:e=>{let{onToggle:t}=e;return(0,l.createElement)(b.Button,{onClick:t,className:"ugb-modal-design-library__stk-color-scheme stk-color-scheme__toggle"},""!==G?(0,l.createElement)(b.ColorSchemePreview,{isCollapsed:!0,colors:r[G||n].normal}):(0,l.createElement)(H,{label:(0,u.__)("Default",o.i18n)}))},renderContent:e=>{let{onClose:t}=e;return(0,l.createElement)("div",null,(0,l.createElement)("div",{className:"ugb-modal-design-library__stk-color-scheme-list-header"},(0,l.createElement)("p",null," ",(0,u.__)("Container Scheme",o.i18n)),(0,l.createElement)(b.Button,{icon:"no",onClick:()=>{t()}})),(0,l.createElement)("div",{className:"ugb-modal-design-library__stk-color-scheme-list"},(0,l.createElement)(b.Button,{className:"ugb-modal-design-library__stk-color-scheme"+(""===G?" stk-color-scheme__selected":""),onClick:()=>{V("")}},(0,l.createElement)("span",{className:"stk-color-scheme-name stk-color-scheme__none"}," ",(0,u.__)("Default",o.i18n)," ")),Object.entries(r).map(((e,t)=>{let[n,r]=e;return(0,l.createElement)(b.Button,{key:t,className:"ugb-modal-design-library__stk-color-scheme"+(G===n?" stk-color-scheme__selected":""),onClick:()=>{V(n)}},(0,l.createElement)(b.ColorSchemePreview,{colors:r.normal,isCollapsed:!0}),(0,l.createElement)("span",{className:"stk-color-scheme-name"}," ",r.name," "))})),Object.keys(r).length?(0,l.createElement)(b.ColorSchemesHelp,{customText:"",callback:K,className:"ugb-design-library__manage-scheme"}):(0,l.createElement)(b.ColorSchemesHelp,{customText:(0,u.__)("You do not have any color schemes.",o.i18n),callback:K})))}})))),(0,l.createElement)(A,{className:`stk-design-library__item-${w}`,isBusy:a,designs:z,errors:q}),"patterns"===w&&(0,l.createElement)("aside",{className:"ugb-modal-design-library__footer"},(0,l.createElement)("div",null,(0,u.sprintf)((0,u.__)("(%d) Selected",o.i18n),y.length)),(0,l.createElement)(b.Button,{label:(0,u.__)("Add Designs",o.i18n),className:"ugb-modal-design-library__add-multi",disabled:!y.length||E,onClick:()=>Z(v)},(0,u.__)("Add Designs",o.i18n),E&&(0,l.createElement)(d.Spinner,null))))))};L.defaultProps={search:"",onClose:()=>{},onSelect:()=>{},hasVersionSwitcher:!1,apiVersion:"",onChangeApiVersion:()=>{}};const q=L,H=e=>(0,l.createElement)("div",{style:{position:"relative"}},(0,l.createElement)("div",{style:{opacity:"0"}},(0,l.createElement)(b.ColorSchemePreview,{isCollapsed:!0})),(0,l.createElement)("span",{className:"stk-color-scheme-name stk-color-scheme__none"}," ",e.label," "))}}]);